<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for src/components/Track/TrackView.tsx</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../../../prettify.css" />
    <link rel="stylesheet" href="../../../base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../../../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="../../../index.html">All files</a> / <a href="index.html">src/components/Track</a> TrackView.tsx
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>0/42</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>0/14</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>0/5</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>0/38</span>
      </div>
    </div>
  </div>
  <div class='status-line low'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151</td><td class="line-coverage quiet"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">import React, { useRef } from 'react';
<span class="cstat-no" title="statement not covered" >import { observer } from "mobx-react";</span>
<span class="cstat-no" title="statement not covered" >import styles from './TrackView.module.scss';</span>
<span class="cstat-no" title="statement not covered" >import { AgendaItem } from '../AgendaItem/AgendaItemController';</span>
import { IItem } from '../../models/ItemModel';
<span class="cstat-no" title="statement not covered" >import { useDrop, DropTargetMonitor } from 'react-dnd';</span>
import { XYCoord } from 'dnd-core';
import { DragObject } from '../../interfaces/dndInterfaces'
<span class="cstat-no" title="statement not covered" >import uuid from 'uuid';</span>
<span class="cstat-no" title="statement not covered" >import throttle from 'lodash/throttle';</span>
import { ICustomItemAction } from '../../interfaces/agendaProps';
<span class="cstat-no" title="statement not covered" >import classNames from 'classnames';</span>
<span class="cstat-no" title="statement not covered" >import { Icon } from 'office-ui-fabric-react/lib/Icon';</span>
&nbsp;
&nbsp;
&nbsp;
&nbsp;
&nbsp;
export interface IProps {
    items: Array&lt;IItem&gt;,
    numberOfSegments: number,
    numberOfSmallSegments: number,
    smallSegmentHeight: number,
    handleDropHover: (hoverClientY: number, dragObject: DragObject) =&gt; void,
    handleInitializeDrawUp: (initialMousePosition: number) =&gt; void,
    handleDrawUp: (initialMousePosition: number, currentMousePosition: number) =&gt; void,
    customItemActions?: Array&lt;ICustomItemAction&gt;,
    finishDrawUp: () =&gt; void,
    enableHover: boolean,
    refScrollContainer: React.RefObject&lt;HTMLDivElement&gt;
}
&nbsp;
const TrackView: React.FC&lt;IProps&gt; = <span class="cstat-no" title="statement not covered" ><span class="fstat-no" title="function not covered" >(</span>{</span>
    items,
    numberOfSegments,
    numberOfSmallSegments,
    smallSegmentHeight,
    handleDropHover,
    handleInitializeDrawUp,
    handleDrawUp,
    finishDrawUp,
    customItemActions,
    enableHover,
    refScrollContainer
}: IProps) =&gt; {
    const agendaItems = <span class="cstat-no" title="statement not covered" >items.map(<span class="fstat-no" title="function not covered" >(</span>item: IItem) =&gt; <span class="cstat-no" title="statement not covered" >&lt;AgendaItem key={item.id} item={item} customItemActions={customItemActions}&gt;&lt;/AgendaItem&gt;)</span></span>
    const containerRef = <span class="cstat-no" title="statement not covered" >useRef&lt;HTMLDivElement&gt;(null)</span>
    const segmentsRef = <span class="cstat-no" title="statement not covered" >useRef&lt;HTMLDivElement&gt;(null)</span>
&nbsp;
&nbsp;
    const throttledDropHover = <span class="cstat-no" title="statement not covered" >throttle(handleDropHover, 20);</span>
    // const throttledScrollDown = throttle(() =&gt; refScrollContainer.current!.scrollBy({ top: 20, left: 0 }), 20);
    // const throttledScrollDown = throttle(() =&gt; { 
    //     refScrollContainer.current!.scrollTop =  refScrollContainer.current!.scrollTop + 1;
    //  }, 0.1);
&nbsp;
    // const throttledScrollUp = throttle(() =&gt; refScrollContainer.current!.scrollBy({ top: -20, left: 0 }), 20);
&nbsp;
    // const throttledScrollDown = () =&gt; window.requestAnimationFrame(() =&gt; refScrollContainer.current!.scrollBy({ top: 3, left: 0 }));
    // const throttledScrollUp = () =&gt; window.requestAnimationFrame(() =&gt;refScrollContainer.current!.scrollBy({ top: -3, left: 0 }));
&nbsp;
&nbsp;
&nbsp;
&nbsp;
    const <span class="cstat-no" title="statement not covered" >[, <span class="cstat-no" title="statement not covered" >drop] = useDrop({</span></span>
        accept: 'item',
        hover(dragObject: DragObject, monitor: DropTargetMonitor) {
            const hoverBoundingRect = containerRef.current!.getBoundingClientRect();
            const sourceClientOffset = monitor.getSourceClientOffset();
            const hoverClientY = (sourceClientOffset as XYCoord).y - hoverBoundingRect.top;
            throttledDropHover(hoverClientY, dragObject);
&nbsp;
            const clientOffsetY = (monitor.getClientOffset() as XYCoord).y;
            const scrollContainerBoundingRect = refScrollContainer.current!.getBoundingClientRect();
            const diffTop = clientOffsetY - scrollContainerBoundingRect.top;
            if (diffTop &gt;= 0 &amp;&amp; diffTop &lt; 20) {
                // throttledScrollUp();
&nbsp;
            }
            const diffBottom = clientOffsetY - scrollContainerBoundingRect.bottom;
            if (diffBottom &lt;= 0 &amp;&amp; diffBottom &gt; -20) {
                // throttledScrollDown();
            }
        },
    })
&nbsp;
<span class="cstat-no" title="statement not covered" >    drop(containerRef);</span>
&nbsp;
    let initialMousePosition: number;
    const initializeDrawUp = <span class="cstat-no" title="statement not covered" ><span class="fstat-no" title="function not covered" >(</span>event: any) =&gt; {</span>
<span class="cstat-no" title="statement not covered" >        if (!enableHover) <span class="cstat-no" title="statement not covered" >r</span>eturn;</span>
<span class="cstat-no" title="statement not covered" >        if (event &amp;&amp; segmentsRef.current) {</span>
<span class="cstat-no" title="statement not covered" >            if (event.buttons !== 1) <span class="cstat-no" title="statement not covered" >r</span>eturn;</span>
<span class="cstat-no" title="statement not covered" >            event.preventDefault();</span>
<span class="cstat-no" title="statement not covered" >            initialMousePosition = event.clientY - segmentsRef.current.getBoundingClientRect().top;</span>
        }
<span class="cstat-no" title="statement not covered" >        handleInitializeDrawUp(initialMousePosition);</span>
<span class="cstat-no" title="statement not covered" >        window.addEventListener('mousemove', drawUp); //TODO: throttle here</span>
<span class="cstat-no" title="statement not covered" >        window.addEventListener('mouseup', stopDrawUp);</span>
    }
&nbsp;
&nbsp;
    const drawUp = <span class="cstat-no" title="statement not covered" ><span class="fstat-no" title="function not covered" >(</span>e: any) =&gt; {</span>
<span class="cstat-no" title="statement not covered" >        if (segmentsRef.current) {</span>
<span class="cstat-no" title="statement not covered" >            handleDrawUp(initialMousePosition, e.clientY - segmentsRef.current!.getBoundingClientRect().top)</span>
        }
    }
&nbsp;
    const stopDrawUp = <span class="cstat-no" title="statement not covered" ><span class="fstat-no" title="function not covered" >() =&gt; {</span></span>
<span class="cstat-no" title="statement not covered" >        window.removeEventListener('mousemove', drawUp);</span>
<span class="cstat-no" title="statement not covered" >        window.removeEventListener('mouseup', stopDrawUp);</span>
<span class="cstat-no" title="statement not covered" >        finishDrawUp();</span>
&nbsp;
    }
&nbsp;
&nbsp;
    let smallSegments: Array&lt;JSX.Element&gt; = <span class="cstat-no" title="statement not covered" >[];</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    for (let i: number = 0; i &lt; numberOfSmallSegments; i++) {</span>
<span class="cstat-no" title="statement not covered" >        smallSegments.push(&lt;div key={uuid()} className={classNames(styles.smallSegment)} style={{ height: smallSegmentHeight + 'px', borderBottom: i == numberOfSmallSegments - 1 ? '1px dashed var(--neutralQuaternary)' : '' }}&gt;</span>
            {enableHover ?
                &lt;div className={styles.smallSegmentHoverContainer}&gt;
                    &lt; Icon iconName="ChevronUp" className={styles.chevronIcon} /&gt;
                    &lt;div className={styles.smallSegmentText}&gt;&lt;Icon iconName="AddTo" className={styles.addIcon} /&gt;Create new agenda item&lt;/div&gt;
                    &lt;Icon iconName="ChevronDown" className={styles.chevronIcon} /&gt;
                &lt;/div&gt;
&nbsp;
                : null}
        &lt;/div&gt;)
    }
&nbsp;
    let segments: Array&lt;JSX.Element&gt; = <span class="cstat-no" title="statement not covered" >[];</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    for (let i: number = 0; i &lt; numberOfSegments; i++) {</span>
<span class="cstat-no" title="statement not covered" >        segments.push(&lt;div key={uuid()} className={styles.segment}&gt;</span>
            {smallSegments}
        &lt;/div&gt;)
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    return (</span>
        &lt;div className={styles.container} ref={containerRef}&gt;
            &lt;div className={styles.segmentsContainer} onMouseDown={initializeDrawUp} ref={segmentsRef}&gt;
                {segments}
            &lt;/div&gt;
            {agendaItems}
        &lt;/div&gt;
    );
}
&nbsp;
export default observer(TrackView);
&nbsp;</pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->
<div class='footer quiet pad2 space-top1 center small'>
  Code coverage
  generated by <a href="https://istanbul.js.org/" target="_blank">istanbul</a> at Thu Dec 19 2019 12:34:50 GMT+0100 (Central European Standard Time)
</div>
</div>
<script src="../../../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../../../sorter.js"></script>
</body>
</html>
